rule "Voice control"
when
    Item VoiceCommand received update
then
    var String command = VoiceCommand.state.toString.toLowerCase
    logInfo("Voice.Rec","VoiceCommand received "+command)
    var Number newState = 100
    newState = 100

    // find new state, toggle otherwise (if possible)
    if (command.contains("off")|| command.contains("stop")) {
        newState = 0
    } else if (command.contains("on") || command.contains("start")) {
        newState = 1
    } else if (command.contains("bright") || command.contains("green")) {
        newState = 2
    }
    logInfo("Voice.Rec", "Detected state is: "+newState)

	
    if (newState < 100) {
	// find scene
	if (command.contains("living")) {
	    sendCommand(KamerScene, newState)
	} 
	if (command.contains("downstairs")) {
	    sendCommand(TafelScene, newState)
	    sendCommand(KamerScene, newState)
	    sendCommand(KeukenAanScene, newState)
	    if (command.contains("everything") && (newState==0)) {
		sendCommand(HubActivity,"PowerOff")
	    }
	} 
        if (command.contains("table")) {
	    sendCommand(TafelScene, newState)
	} 
        if (command.contains("kitchen") ) {
	    sendCommand(KeukenAanScene, newState)
	}
	if (command.contains("stairs")) {
	    sendCommand(OverloopVoorScene, newState)
	} 
        if (command.contains("playstation") || command.contains("console")) {
	    if (newState == 1) {
		sendCommand(HubActivity,"PS3 Spelen")
	    } else {
		sendCommand(HubActivity,"PowerOff")
	    }
	}
        if (command.contains("squeezebox") || command.contains("music")) {
	    if (newState == 1) {
		sendCommand(HubActivity,"Muziek Luisteren")
	    } else {
		sendCommand(HubActivity,"PowerOff")
	    }
	}

        if (command.contains("wii") || command.contains("joshi")) {
	    if (newState == 1) {
		sendCommand(HubActivity,"Wii-en")
	    } else {
		sendCommand(HubActivity,"PowerOff")
	    }
	}
        if (command.contains("media player") || command.contains("raspberry pi")) {
	    if (newState == 1) {
		sendCommand(HubActivity,"Media Kijken")
	    } else {
		sendCommand(HubActivity,"PowerOff")
	    }
	}
        if (command.contains("delta")) {
	   if (DriesOnderweg.state == ON) {
			logInfo("Voice.Rec", "Door state is: "+DriesOnderweg.state)
			sendCommand(Garage, ON)
			sendCommand(DriesOnderweg,OFF)
	   }
	}
    }
end
